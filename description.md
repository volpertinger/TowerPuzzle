# Описание программы

## Краткое описание логики

### Класс \_\_Cell 

Этот класс используется для представления клетки в игровом поле и содержит функции для работы с клетками.
Содержит поле массива, в котором хранятся возможные числа для клетки.

#### Функция \_\_str\_\_ 

Реализована для строкового представления клетки. Клетка представляется ввиде [. . .], где вместо точек 
стоит N символов (N - размер игры) таких, что: символ = "-", если число в этой клетке стоять не может
и символ является числом, если это число может стоять в клетке. 

#### Функция \_\_int\_\_

Если в клетке стоит только одно число, то возвращаем его. Если несколько чисел может стоять в клетке, то
возвращаем 0.

#### Функция \_\_eq\_\_

Сравнивает клетки между собой и возвращает True, если клекти равны и False иначе.

#### Функция \_\_bool\_\_

Возвращает True, если в клетке стоит одно число и False иначе.

#### Функция set

Оставляет в клетке только заданное число, остальные убирает.

#### Функция remove

Убирает из клетки только заданное число.

#### Функция get_not_zeros

Возвращает все числа, которые могут стоять в клетке.

### Класс TowerPuzzle

Представляет собой поле и функции для работы с ним, решения головоломки. Сожержит следующие поля:

1. Четыре массива видимостей слева, сверху, справа, снизу.
2. Размер поля
3. Само поле, которое представляет собой двумерный массив клеток

#### Функция \_\_str\_\_

Нужна для наглядного представления поля со всеми видимостями и возможными значениями в клетках.

#### Функция get_field_from_arrray

Принимает на вход двумерный массив целых чисел и возвращает двумерный массив клеток 
(числу 0 во входном массиве соответствует клетка со всеми возможными числами, другим числам - клетка
с одним возможным заданным числом). Нужна для того, чтобы менее громоздко создавать поля.

#### Функция \_\_get_right_vector_from_possible

принимает на вход матрицу из векторов клеток (эти вектора являются всеми возможными комбинациями строки или транспонированного столбца, которые получаются из другой функции) и две крайние видимости.
Возвращает матрицу клеток, в котрой  каждая строка является верной по проверке видимостей и отсутствия дублей.

#### Функция \_\_get_cell_vector_from_matrix

принимает на вход матрицу из векторов клеток и возвращает один вектор, состоящий из клеток, который, по сути, является обобщением матрицы. Т.е. эта функции их возможных комбинаций вектора делает вектор
клеток, в которых, в зависимости от исходной матрицы, на определенных позициях в клетках возможны определенные значения.

#### Функция get_field_string

Эта функция нужная для упрощенного представления поля головоломки ввиде строки. На выходе получается строчное представление матрицы, где последовательно выписаны ее элементы, причем если число в клетке определено однозначно, то оно и ставится, а если есть несколько вариантов для клетки, то ставится на соответственную позицию 0.

#### Функции \_\_count_visibility_[left/right/up/down]

Принимает на вход индекс и считает текущую видимость в нужной строке\столбце в направлении, зависящем от функции.

#### Функция \_\_count_unfilled_cells_[horizontal/vertical]

Принимает на вход индекс и считает количество клеток в нужной строке\столбце, в которых однозначно не определено число.

#### Функция \_\_count_brute_force_variants

Возвращает число вариантов для перебора для текущего состояния поля для первой клетки (обход матрицы слева направо и сверху вниз), значение для которой не определено.

#### Функция \_\_is_unique_[row/column]

Получает на вход строку\стлбец и возвращает True, если в векторе нет повторяющихся клеток с точно определенными значениями.

#### Функция \_\_is_solved

Проверяет, решена ли игра по текущему полю. Возвращает True, если игра решена и False иначе

#### Функция \_\_is_correct

Проверяет текущее поле на корректность (здесь, в отличие от предыдущей функции, учитывается, что клетки могут быть не заполнены)

#### Функция \_\_set

Принимает на вход индексы и число, которое нужно поставить в клетку по нужным индексам. Если значение в клетке уже определено, то ничего функция не делает. Иначе - ставит число.

#### Функция \_\_remove

Принимает на вход индексы и число, которое нужно удалить из клетки. Если значение в клетке определено, то возвращает False. Иначе - удаляет число по индексам.

#### Функция \_\_remove_higher

Принимает на вход индексы и число. И вызывает функцию \_\_remove для всех чисел, больших заданного.

#### Функция \_\_solve_trivial_highest

Рещает примитивный случай, когда видимость = 1

#### Функция \_\_solve_base_restrictions

Распространяет базовые ограничения из условий видимости.

#### Функция \_\_solve_castle_restrictions

Получает на вход индексы. Если по этому индексу число в клетке не определено однозначно, то ничего функция не делает. Иначе в строке и столбце, исходя из индексов, за исключнием этой клетки, вызывает \_\_remove по индексу и числу, которое однозначно определено в исходной клетке.

#### Функция \_\_solve_only_one_[row\column]

Если в заданной строке\столбце исходя из ограничений только в одной клетке возможно определенное число, то оно и выставляется.

#### Функция \_\_get_possible_[rows\columns]

Получает на вход индекс строки\столбца и для строит матрицу возможных векторов исходя из ограничений.

#### Функция \_\_solve_visibility_restriction_[row\column]

Получает на вход индекс строки\столбца и для него составляет возможные комбинации векторов исходя из ограничений, затем отбирает верные исходя из видимостей и составляет вектор клеток (с помощью вызова уже описанных ранее функций). Затем, если так оказалось, что вектор клеток пустой (нет возможных правильных комбинаций), то возвращается False. Затем проверяется, равняется полученний вктор исходному в поле. Если равняется, то вовзращается False. Иначе - True.

#### Функция \_\_solve_number_brute_force

получает на вход позицию, с которой начинать перебор. Затем идет по полю и, когда достигает нужной позиции, ставит число в клетку. Если позиции достигнуть не удается (т.е. уже все возможное перебрали), то возвращается False. Иначе - True.

#### Функция \_\_solve_trivial_cases

Вызывает функции для решения тривиальных случаев для стартовой позиции.

#### Функция \_\_solve_by_restrictions

Решает задачу алгоритмом распространения ограничений, без перебора. Если никаким из непереборных способов решить не удается, возвращает True, если задача решена и False иначе.

#### Функция \_\_solve 

Полностью решает задачу с учтом перебора, если это нужно. Сначала решает распространением ограничений, затем, если эти методом решить нельзя и задача еще не решена, вставляет значение для одной клетки перебором, а затем снова алгоритмом рспространения ограничений. При этом сохраняются точки, в которых начался перебор (поле и позиция), чтобы если перебор ведет в тупик, вернуться назад. В случае, если нельзя решить распространением ограничений и закончились варианты для перебора, возвращается False. Если игра решена, то возвращается True.
